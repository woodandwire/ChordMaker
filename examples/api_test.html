<!DOCTYPE html>
<html>
<head>
    <title>Quick API Test</title>
</head>
<body>
    <h2>Testing Fixed API</h2>
    <button onclick="testAPI()">Test Validation API</button>
    <div id="result"></div>
    
    <script>
    async function testAPI() {
        const resultDiv = document.getElementById('result');
        resultDiv.innerHTML = 'Testing...';
        
        // Test data that would previously cause 422 error
        const formData = new FormData();
        formData.append('finger1', 'X');
        formData.append('fret1', '0');  // This is the fix - '0' instead of ''
        formData.append('finger2', '1');
        formData.append('fret2', '3');
        formData.append('finger3', '2');
        formData.append('fret3', '2');
        formData.append('finger4', '3');
        formData.append('fret4', '1');
        formData.append('finger5', 'X');
        formData.append('fret5', '0');  // Fixed
        formData.append('finger6', 'X');
        formData.append('fret6', '0');  // Fixed
        
        try {
            const response = await fetch('http://localhost:8001/api/validate', {
                method: 'POST',
                body: formData
            });
            
            if (response.ok) {
                const result = await response.json();
                resultDiv.innerHTML = `
                    <h3>✓ SUCCESS!</h3>
                    <p>Status: ${response.status}</p>
                    <p>Valid: ${result.is_valid}</p>
                    <p>Status Name: ${result.status_name}</p>
                    <p>No more 422 errors!</p>
                `;
            } else {
                const errorText = await response.text();
                resultDiv.innerHTML = `
                    <h3>✗ Error</h3>
                    <p>Status: ${response.status}</p>
                    <p>Error: ${errorText}</p>
                `;
            }
        } catch (error) {
            resultDiv.innerHTML = `<h3>✗ Network Error</h3><p>${error}</p>`;
        }
    }
    </script>
</body>
</html>